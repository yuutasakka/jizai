# Jizai Vault Subscription System - Environment Variables
# Copy to .env and update with your actual values

# ============================================================================
# EXISTING JIZAI CONFIG (keep existing values)
# ============================================================================
PORT=3000
DASHSCOPE_API_KEY=sk-your-dashscope-api-key-here

# ============================================================================
# SUPABASE CONFIGURATION
# ============================================================================
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# Database connection (for direct Postgres access if needed)
DATABASE_URL=postgresql://postgres:password@db.your-project-id.supabase.co:5432/postgres

# ============================================================================
# APP STORE CONNECT CONFIGURATION
# ============================================================================

# App Store Server Notifications v2
APPSTORE_WEBHOOK_SECRET=your-webhook-secret-for-signature-verification
APPSTORE_SHARED_SECRET=your-app-specific-shared-secret
APPSTORE_BUNDLE_ID=com.jizai.vault

# App Store Connect API (for receipt validation)
APPSTORE_KEY_ID=your-key-id
APPSTORE_ISSUER_ID=your-issuer-id
APPSTORE_PRIVATE_KEY_PATH=./keys/AuthKey_YOUR_KEY_ID.p8

# Sandbox vs Production
APPSTORE_ENVIRONMENT=sandbox
# APPSTORE_ENVIRONMENT=production

# ============================================================================
# SUBSCRIPTION CONFIGURATION
# ============================================================================

# Trial period (days)
DEFAULT_TRIAL_DAYS=14

# Grace period after failed renewal (days)  
DEFAULT_GRACE_DAYS=30

# Deletion delay after grace period (days)
DEFAULT_DELETION_DELAY_DAYS=90

# Storage quotas (GB) - should match subscription tiers in database
LITE_STORAGE_QUOTA_GB=5
STANDARD_STORAGE_QUOTA_GB=25
PRO_STORAGE_QUOTA_GB=100

# File size limits (bytes)
MAX_FILE_SIZE_IMAGE=52428800        # 50MB
MAX_FILE_SIZE_VIDEO=524288000       # 500MB  
MAX_FILE_SIZE_DOCUMENT=26214400     # 25MB
MAX_FILE_SIZE_AUDIO=104857600       # 100MB

# ============================================================================
# FAMILY SHARING CONFIGURATION
# ============================================================================

# Invitation expiry (hours)
FAMILY_INVITE_EXPIRY_HOURS=72

# Default access grant period (days)
DEFAULT_ACCESS_GRANT_DAYS=7

# Maximum access grant period (days)
MAX_ACCESS_GRANT_DAYS=30

# ============================================================================
# PRINT EXPORT CONFIGURATION
# ============================================================================

# Export job timeout (minutes)
PRINT_EXPORT_TIMEOUT_MINUTES=30

# Export file retention (days)
PRINT_EXPORT_RETENTION_DAYS=30

# Supported DPI values (comma-separated)
SUPPORTED_DPI_VALUES=300,350

# Default bleed (mm)
DEFAULT_BLEED_MM=3

# Maximum print dimensions (mm)
MAX_PRINT_WIDTH_MM=2000
MAX_PRINT_HEIGHT_MM=2000

# ============================================================================
# FILE STORAGE CONFIGURATION
# ============================================================================

# Supabase Storage bucket names
STORAGE_BUCKET_MEMORIES=vault-memories
STORAGE_BUCKET_THUMBNAILS=vault-thumbnails
STORAGE_BUCKET_EXPORTS=vault-exports

# File processing
IMAGE_QUALITY_JPEG=95
IMAGE_QUALITY_WEBP=85
THUMBNAIL_MAX_SIZE=300

# ============================================================================
# NOTIFICATION CONFIGURATION
# ============================================================================

# Email settings (for family invitations, etc.)
SMTP_HOST=your-smtp-host
SMTP_PORT=587
SMTP_USER=your-smtp-username
SMTP_PASS=your-smtp-password
FROM_EMAIL=noreply@jizai.app

# SMS settings (for verification codes)
SMS_PROVIDER=twilio
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================

# JWT secret (for internal token signing)
JWT_SECRET=your-long-random-jwt-secret-here

# Rate limiting
RATE_LIMIT_WINDOW_MINUTES=15
RATE_LIMIT_MAX_REQUESTS=100

# Webhook security
WEBHOOK_RATE_LIMIT_MAX=50
WEBHOOK_RATE_LIMIT_WINDOW_MINUTES=5

# ============================================================================
# MONITORING AND LOGGING
# ============================================================================

# Log level (error, warn, info, debug)
LOG_LEVEL=info

# Enable performance monitoring
ENABLE_METRICS=true

# Sentry DSN (optional)
SENTRY_DSN=your-sentry-dsn-here

# Health check settings
HEALTH_CHECK_INTERVAL_MINUTES=5

# ============================================================================
# DEVELOPMENT SETTINGS
# ============================================================================

# Enable debug mode (additional logging)
DEBUG_MODE=false

# Enable API documentation
ENABLE_API_DOCS=true

# Cors origins (comma-separated)
CORS_ORIGINS=http://localhost:3001,http://localhost:8080

# ============================================================================
# BACKGROUND JOB CONFIGURATION
# ============================================================================

# Job queue settings
JOB_CONCURRENCY=5
JOB_RETRY_ATTEMPTS=3
JOB_RETRY_DELAY_SECONDS=30

# Cleanup job frequency (cron expressions)
CLEANUP_EXPIRED_INVITATIONS_CRON="0 2 * * *"
CLEANUP_OLD_EXPORTS_CRON="0 3 * * *"
CLEANUP_DELETED_SUBSCRIPTIONS_CRON="0 4 * * 0"

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable family sharing features
FEATURE_FAMILY_SHARING=true

# Enable print export features  
FEATURE_PRINT_EXPORT=true

# Enable subscription management
FEATURE_SUBSCRIPTIONS=true

# Enable advanced analytics
FEATURE_ANALYTICS=true

# Beta features
BETA_ENHANCED_SEARCH=false
BETA_AI_TAGGING=false