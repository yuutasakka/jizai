# Enhanced Jizai Backend with Vault Subscription System
# Environment Configuration for Memorial Storage SaaS

# ========================================
# LEGACY IMAGE EDITING (Required)
# ========================================

# üîë REQUIRED: Qwen API Key (get from: https://dashscope.aliyun.com/)
DASHSCOPE_API_KEY=your_qwen_api_key_here

# ========================================
# SUPABASE DATABASE (Required for Vault System)
# ========================================

# üóÑÔ∏è Supabase Configuration
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_KEY=your_supabase_service_role_key
# JWT Secret for RLS authentication (from Supabase -> Settings -> API)
SUPABASE_JWT_SECRET=your_jwt_secret

# ========================================
# SERVER CONFIGURATION
# ========================================

# üåê Server Configuration
PORT=3000
NODE_ENV=development

# üîí CORS Configuration (Environment-aware, comma-separated origins)
# Development: Automatically includes localhost variants (3000, 5173, etc)
# Production: Use only HTTPS origins for security. localhost origins will trigger warnings.
# Examples:
#   Development: ORIGIN_ALLOWLIST=http://192.168.1.100:3000
#   Production:  ORIGIN_ALLOWLIST=https://jizai.vercel.app,https://jizai-ai.com
ORIGIN_ALLOWLIST=https://jizai.vercel.app,https://jizai-ai.com

# ========================================
# RATE LIMITING
# ========================================

# üìä Rate Limiting Configuration
RATE_LIMIT_RPS=100              # General endpoints (15ÂàÜÈñì)
EDIT_RATE_LIMIT=5               # Image editing (1ÂàÜÈñì)
PURCHASE_RATE_LIMIT=10          # Purchase processing (1ÂàÜÈñì)
VAULT_UPLOAD_RATE_LIMIT=20      # Memory uploads (1ÂàÜÈñì)

# ========================================
# APP STORE INTEGRATION
# ========================================

# üçé App Store Connect Configuration
APPLE_BUNDLE_ID=com.yourcompany.jizai
APPLE_TEAM_ID=YOUR_APPLE_TEAM_ID
APPLE_KEY_ID=YOUR_APPLE_KEY_ID
APPLE_PRIVATE_KEY_PATH=./certs/AuthKey_YOUR_KEY_ID.p8

# App Store Server Notifications
APPLE_ROOT_CERTS=./certs/apple-root-certs.pem
APPLE_WEBHOOK_SECRET=your_webhook_secret_key

# Product IDs
APPLE_PRODUCT_LITE=com.yourcompany.jizai.vault.lite
APPLE_PRODUCT_STANDARD=com.yourcompany.jizai.vault.standard
APPLE_PRODUCT_PRO=com.yourcompany.jizai.vault.pro

# ========================================
# STORAGE & FILE HANDLING
# ========================================

# üìÅ File Upload Configuration
MAX_FILE_SIZE_EDIT=10485760      # 10MB for image editing
MAX_FILE_SIZE_VAULT=104857600    # 100MB for vault memories
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,video/mp4,audio/mpeg,application/pdf

# Supabase Storage
SUPABASE_STORAGE_BUCKET=vault-memories
SUPABASE_STORAGE_URL=https://your-project.supabase.co/storage/v1

# ========================================
# SUBSCRIPTION CONFIGURATION
# ========================================

# üìÖ Subscription Settings
TRIAL_DURATION_DAYS=14
GRACE_PERIOD_DAYS=30
DELETION_SCHEDULE_DAYS=90

# Storage Quotas (in bytes)
STORAGE_QUOTA_FREE=1073741824      # 1GB
STORAGE_QUOTA_LITE=5368709120      # 5GB
STORAGE_QUOTA_STANDARD=21474836480 # 20GB
STORAGE_QUOTA_PRO=107374182400     # 100GB

# ========================================
# NOTIFICATION & EMAIL
# ========================================

# üìß Email Configuration (Optional)
SMTP_HOST=smtp.your-provider.com
SMTP_PORT=587
SMTP_USER=your-email@domain.com
SMTP_PASS=your-email-password
FROM_EMAIL=noreply@yourapp.com

# Notification Settings
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_PUSH_NOTIFICATIONS=true

# ========================================
# PRINT EXPORT SERVICES
# ========================================

# üñ®Ô∏è Print Export Configuration
PRINT_EXPORT_STORAGE=./exports
PRINT_EXPORT_MAX_SIZE=104857600   # 100MB max export size
PRINT_EXPORT_EXPIRY_HOURS=168     # 7 days

# External Print Services (Optional)
PRINT_SERVICE_API_KEY=your_print_service_key
PRINT_SERVICE_WEBHOOK_URL=https://yourapp.com/v1/webhooks/print-status

# ========================================
# SECURITY & MONITORING
# ========================================

# üîê Security Configuration
JWT_SECRET=your_super_secret_jwt_key_here
ENCRYPTION_KEY=your_32_character_encryption_key!!

# Session & Auth
SESSION_SECRET=your_session_secret_key
SESSION_TIMEOUT_MINUTES=60

# üìà Monitoring & Logging
LOG_LEVEL=info
ENABLE_REQUEST_LOGGING=true
ENABLE_PERFORMANCE_MONITORING=true

# Health Check
HEALTH_CHECK_INTERVAL_MINUTES=5

# ========================================
# DEVELOPMENT & TESTING
# ========================================

# üß™ Development Settings
ENABLE_DEBUG_LOGGING=true
ENABLE_WEBHOOK_TESTING=true
MOCK_APP_STORE_RECEIPTS=false

# Test Configuration
TEST_DEVICE_ID=test_device_12345
TEST_USER_EMAIL=test@yourapp.com

# ========================================
# EXTERNAL SERVICES (Optional)
# ========================================

# üå©Ô∏è AWS S3 (Alternative to Supabase Storage)
# AWS_ACCESS_KEY_ID=your_aws_access_key
# AWS_SECRET_ACCESS_KEY=your_aws_secret_key  
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=jizai-vault-memories

# Redis (For caching and sessions)
# REDIS_URL=redis://localhost:6379
# REDIS_PASSWORD=your_redis_password

# Analytics
# ANALYTICS_API_KEY=your_analytics_key
# SENTRY_DSN=your_sentry_dsn